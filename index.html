<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T9/T9A å·¥ç¨‹ç®¡ç†ç³»çµ±</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Arial, sans-serif; }
        body { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; padding: 20px; color: #fff; }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 20px; color: #00d4ff; font-size: 1.8em; }
        .system-tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .system-tab { flex: 1; padding: 15px; border: none; border-radius: 10px; cursor: pointer; font-size: 1em; transition: all 0.3s; background: rgba(255,255,255,0.1); color: #fff; }
        .system-tab.active { background: linear-gradient(135deg, #00d4ff, #0099cc); color: #000; }
        .selection-row { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .selection-row select { flex: 1; padding: 12px; border: none; border-radius: 8px; background: rgba(255,255,255,0.15); color: #fff; font-size: 1em; min-width: 150px; }
        .selection-row select:focus { outline: none; background: rgba(255,255,255,0.25); }
        .form-card { background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin-bottom: 20px; backdrop-filter: blur(10px); }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 15px; }
        .form-group { display: flex; flex-direction: column; }
        label { margin-bottom: 5px; color: #aaa; font-size: 0.9em; }
        input, select, textarea { padding: 12px; border: none; border-radius: 8px; background: rgba(255,255,255,0.15); color: #fff; font-size: 1em; }
        input:focus, select:focus, textarea:focus { outline: none; background: rgba(255,255,255,0.25); }
        textarea { resize: vertical; min-height: 60px; }
        .btn { padding: 12px 25px; border: none; border-radius: 8px; cursor: pointer; font-size: 1em; transition: all 0.3s; }
        .btn-primary { background: linear-gradient(135deg, #00d4ff, #0099cc); color: #fff; }
        .btn-danger { background: linear-gradient(135deg, #ff4757, #cc0022); color: #fff; }
        .task-list { display: grid; gap: 15px; }
        .task-card { background: rgba(255,255,255,0.1); padding: 15px; border-radius: 12px; border-left: 4px solid #00d4ff; }
        .task-card.priority-high { border-left-color: #ff4757; }
        .task-card.priority-medium { border-left-color: #ffa502; }
        .task-card.priority-low { border-left-color: #2ed573; }
        .task-header { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .åˆ¤é ­å, .äººå“¡å { font-size: 1.1em; font-weight: bold; color: #00d4ff; }
        .å„ªå…ˆåº¦ { padding: 2px 10px; border-radius: 15px; font-size: 0.8em; }
        .å„ªå…ˆåº¦.high { background: #ff4757; }
        .å„ªå…ˆåº¦.medium { background: #ffa502; }
        .å„ªå…ˆåº¦.low { background: #2ed573; }
        .task-content { color: #ddd; margin-bottom: 8px; }
        .task-dates { font-size: 0.85em; color: #aaa; }
        .task-actions { margin-top: 10px; display: flex; gap: 8px; }
        .filter-bar { display: flex; gap: 8px; margin-bottom: 15px; flex-wrap: wrap; }
        .filter-btn { padding: 8px 15px; border-radius: 20px; background: rgba(255,255,255,0.1); color: #fff; cursor: pointer; border: none; }
        .filter-btn.active { background: #00d4ff; color: #000; }
        .empty-state { text-align: center; padding: 30px; color: #666; }
        .current-selection { background: rgba(255,165,2,0.2); padding: 10px 15px; border-radius: 8px; margin-bottom: 15px; color: #ffa502; font-size: 0.9em; }
        .hidden { display: none !important; }
        .section-title { color: #ffa502; font-weight: bold; margin-bottom: 10px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ï¸ T9/T9A å·¥ç¨‹ç®¡ç†ç³»çµ±</h1>
        
        <!-- ä¸Šå±¤é¸æ“‡ -->
        <div class="system-tabs">
            <button class="system-tab active" id="tab-foreman" onclick="switchSystem('foreman')">ğŸ‘· åˆ¤é ­è¿½è¹¤ç®¡ç†</button>
            <button class="system-tab" id="tab-selfcheck" onclick="switchSystem('selfcheck')">âœ… æ–°è¼è‡ªæª¢ç®¡ç†</button>
        </div>
        
        <!-- åˆ¤é ­è¿½è¹¤ç®¡ç† -->
        <div id="system-foreman">
            <div class="form-card">
                <h2 class="section-title">â• æ–°å¢ä»»å‹™</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>åˆ¤é ­å</label>
                        <select id="foreman-foreman">
                            <option value="">é¸æ“‡åˆ¤é ­...</option>
                            <option value="PHM">PHM</option>
                            <option value="å‰µåŸº">å‰µåŸº</option>
                            <option value="æŒ¯æº">æŒ¯æº</option>
                            <option value="å‹è‰¯è¨˜">å‹è‰¯è¨˜</option>
                            <option value="æ—­æš‰">æ—­æš‰</option>
                            <option value="èšé¾">èšé¾</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å„ªå…ˆåº¦</label>
                        <select id="foreman-priority">
                            <option value="high">ğŸ”´ é«˜</option>
                            <option value="medium" selected>ğŸŸ¡ ä¸­</option>
                            <option value="low">ğŸŸ¢ ä½</option>
                        </select>
                    </div>
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label>éœ€è™•ç†å…§å®¹</label>
                    <textarea id="foreman-content" placeholder="æè¿°éœ€è¦è™•ç†çš„å·¥ç¨‹äº‹é …..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>ç™¼ç¾å•é¡Œæ—¥æœŸ</label>
                        <input type="date" id="foreman-date1">
                    </div>
                    <div class="form-group">
                        <label>æˆªæ­¢æ—¥æœŸ</label>
                        <input type="date" id="foreman-date2">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="addForemanTask()">âœ… æ–°å¢ä»»å‹™</button>
            </div>
            
            <div class="filter-bar">
                <button class="filter-btn active" onclick="filterForeman('all')">å…¨éƒ¨</button>
                <button class="filter-btn" onclick="filterForeman('high')">ğŸ”´ é«˜</button>
                <button class="filter-btn" onclick="filterForeman('medium')">ğŸŸ¡ ä¸­</button>
                <button class="filter-btn" onclick="filterForeman('low')">ğŸŸ¢ ä½</button>
            </div>
            
            <div id="foreman-list" class="task-list"></div>
        </div>
        
        <!-- æ–°è¼è‡ªæª¢ç®¡ç† -->
        <div id="system-selfcheck" class="hidden">
            <div class="current-selection" id="selfcheck-selection">è«‹å…ˆé¸æ“‡äººå“¡</div>
            
            <div class="form-row">
                <div class="form-group">
                    <label>äººå“¡</label>
                    <select id="selfcheck-person" onchange="updateSelfcheckSelection()">
                        <option value="">é¸æ“‡äººå“¡...</option>
                        <option value="ç™¼">ç™¼</option>
                        <option value="æ¿¤">æ¿¤</option>
                        <option value="Edgar">Edgar</option>
                        <option value="æ–‡è¼">æ–‡è¼</option>
                        <option value="ç›ˆ">ç›ˆ</option>
                        <option value="ç¥º">ç¥º</option>
                        <option value="æ…§æ˜">æ…§æ˜</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>åº§æ•¸</label>
                    <select id="selfcheck-building" onchange="updateSelfcheckSelection()">
                        <option value="">é¸æ“‡åº§æ•¸...</option>
                        <option value="T9">T9</option>
                        <option value="T9A">T9A</option>
                        <option value="T9åŠT9A">T9åŠT9A</option>
                        <option value="SU">SU</option>
                    </select>
                </div>
            </div>
            
            <div class="form-card" id="selfcheck-form" class="hidden">
                <h2 class="section-title">â• æ–°å¢è‡ªæª¢ä»»å‹™</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>å„ªå…ˆåº¦</label>
                        <select id="selfcheck-priority">
                            <option value="high">ğŸ”´ é«˜</option>
                            <option value="medium" selected>ğŸŸ¡ ä¸­</option>
                            <option value="low">ğŸŸ¢ ä½</option>
                        </select>
                    </div>
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label>è‡ªæª¢å…§å®¹</label>
                    <textarea id="selfcheck-content" placeholder="æè¿°è‡ªæª¢äº‹é …..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>ç™¼ç¾æ—¥æœŸ</label>
                        <input type="date" id="selfcheck-date1">
                    </div>
                    <div class="form-group">
                        <label>æˆªæ­¢æ—¥æœŸ</label>
                        <input type="date" id="selfcheck-date2">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="addSelfcheckTask()">âœ… æ–°å¢ä»»å‹™</button>
            </div>
            
            <div id="selfcheck-list" class="task-list"></div>
        </div>
    </div>

    <script>
        // é è¨­åˆ¤é ­
        const DEFAULT_FOREMEN = ['PHM', 'å‰µåŸº', 'æŒ¯æº', 'å‹è‰¯è¨˜', 'æ—­æš‰', 'èšé¾'];
        const PERSONS = ['ç™¼', 'æ¿¤', 'Edgar', 'æ–‡è¼', 'ç›ˆ', 'ç¥º', 'æ…§æ˜'];
        const BUILDINGS = ['T9', 'T9A', 'T9åŠT9A', 'SU'];
        
        // æ•¸æ“š
        let customForemen = JSON.parse(localStorage.getItem('customForemen') || '[]');
        let foremen = [...DEFAULT_FOREMEN, ...customForemen];
        let foremanTasks = JSON.parse(localStorage.getItem('foremanTasks') || '[]');
        let selfcheckTasks = JSON.parse(localStorage.getItem('selfcheckTasks') || '[]');
        let currentSystem = 'foreman';
        let currentPerson = '';
        let currentBuilding = '';
        
        // åˆå§‹åŒ–
        function init() {
            updateForemanDropdown();
            renderForemanTasks();
            renderSelfcheckTasks();
        }
        
        // ç³»çµ±åˆ‡æ›
        function switchSystem(system) {
            currentSystem = system;
            document.getElementById('tab-foreman').classList.toggle('active', system === 'foreman');
            document.getElementById('tab-selfcheck').classList.toggle('active', system === 'selfcheck');
            document.getElementById('system-foreman').classList.toggle('hidden', system !== 'foreman');
            document.getElementById('system-selfcheck').classList.toggle('hidden', system !== 'selfcheck');
        }
        
        // æ›´æ–°åˆ¤é ­ä¸‹æ‹‰
        function updateForemanDropdown() {
            const select = document.getElementById('foreman-foreman');
            const firstOption = select.options[0];
            select.innerHTML = '';
            select.add(firstOption);
            foremen.forEach(f => {
                const option = document.createElement('option');
                option.value = f;
                option.textContent = f;
                select.add(option);
            });
        }
        
        // å„²å­˜åˆ¤é ­åˆ—è¡¨
        function saveForemen() {
            localStorage.setItem('customForemen', JSON.stringify(customForemen));
        }
        
        // ============ åˆ¤é ­è¿½è¹¤ç®¡ç† ============
        function addForemanTask() {
            let foremanName = document.getElementById('foreman-foreman').value;
            const content = document.getElementById('foreman-content').value.trim();
            
            if (!foremanName || !content) {
                alert('è«‹é¸æ“‡åˆ¤é ­ååŒå¡«å¯«å…§å®¹ï¼');
                return;
            }
            
            const task = {
                id: Date.now(),
                foreman: foremanName,
                priority: document.getElementById('foreman-priority').value,
                content: content,
                date1: document.getElementById('foreman-date1').value,
                date2: document.getElementById('foreman-date2').value,
                result: '',
                completed: false,
                time: new Date().toLocaleTimeString('zh-HK', {hour:'2-digit',minute:'2-digit'})
            };
            
            foremanTasks.unshift(task);
            saveForemanTasks();
            clearForemanForm();
        }
        
        function saveForemanTasks() {
            localStorage.setItem('foremanTasks', JSON.stringify(foremanTasks));
            renderForemanTasks();
        }
        
        function clearForemanForm() {
            document.getElementById('foreman-foreman').value = '';
            document.getElementById('foreman-content').value = '';
            document.getElementById('foreman-date1').value = '';
            document.getElementById('foreman-date2').value = '';
            document.getElementById('foreman-priority').value = 'medium';
        }
        
        function filterForeman(priority) {
            document.querySelectorAll('#system-foreman .filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            renderForemanTasks(priority);
        }
        
        function renderForemanTasks(filter = 'all') {
            const container = document.getElementById('foreman-list');
            let filtered = foremanTasks;
            if (filter !== 'all') filtered = foremanTasks.filter(t => t.priority === filter);
            
            if (filtered.length === 0) {
                container.innerHTML = '<div class="empty-state">æš«æ™‚å†‡ä»»å‹™</div>';
                return;
            }
            
            container.innerHTML = filtered.map(task => `
                <div class="task-card priority-${task.priority} ${task.completed ? 'å®Œæˆ' : ''}">
                    <div class="task-header">
                        <span class="åˆ¤é ­å">ğŸ‘· ${task.foreman}</span>
                        <span class="å„ªå…ˆåº¦ ${task.priority}">${task.priority==='high'?'ğŸ”´é«˜':task.priority==='medium'?'ğŸŸ¡ä¸­':'ğŸŸ¢ä½'}</span>
                    </div>
                    <div class="task-content">${task.content}</div>
                    <div class="task-dates">ğŸ“… ${task.date1||'æœªå¡«'} | â° ${task.date2||'æœªå¡«'} | ${task.time}</div>
                    ${task.result ? `<div style="margin-top:8px;padding:8px;background:rgba(0,0,0,0.2);border-radius:5px;">âœ… ${task.result}</div>`:''}
                    <div class="task-actions">
                        <button class="btn btn-primary" style="padding:8px 15px;font-size:0.9em;" onclick="toggleForemanComplete(${task.id})">${task.completed?'â†©ï¸':'âœ…'}</button>
                        <button class="btn" style="padding:8px 15px;font-size:0.9em;" onclick="updateForemanResult(${task.id})">ğŸ“</button>
                        <button class="btn btn-danger" style="padding:8px 15px;font-size:0.9em;" onclick="deleteForemanTask(${task.id})">ğŸ—‘ï¸</button>
                    </div>
                </div>
            `).join('');
        }
        
        function toggleForemanComplete(id) {
            const task = foremanTasks.find(t => t.id === id);
            if (task) { task.completed = !task.completed; saveForemanTasks(); }
        }
        
        function updateForemanResult(id) {
            const task = foremanTasks.find(t => t.id === id);
            if (task) { task.result = prompt('è¼¸å…¥è™•ç†çµæœï¼š', task.result) || ''; saveForemanTasks(); }
        }
        
        function deleteForemanTask(id) {
            if (confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) {
                foremanTasks = foremanTasks.filter(t => t.id !== id);
                saveForemanTasks();
            }
        }
        
        // ============ æ–°è¼è‡ªæª¢ç®¡ç† ============
        function updateSelfcheckSelection() {
            currentPerson = document.getElementById('selfcheck-person').value;
            currentBuilding = document.getElementById('selfcheck-building').value;
            const form = document.getElementById('selfcheck-form');
            
            if (currentPerson && currentBuilding) {
                document.getElementById('selfcheck-selection').innerHTML = `ğŸ“ ${currentPerson} - ${currentBuilding}`;
                form.classList.remove('hidden');
            } else {
                document.getElementById('selfcheck-selection').innerHTML = 'è«‹å…ˆé¸æ“‡äººå“¡å’Œåº§æ•¸';
                form.classList.add('hidden');
            }
            renderSelfcheckTasks();
        }
        
        function addSelfcheckTask() {
            if (!currentPerson || !currentBuilding) {
                alert('è«‹å…ˆé¸æ“‡äººå“¡å’Œåº§æ•¸ï¼');
                return;
            }
            
            const content = document.getElementById('selfcheck-content').value.trim();
            if (!content) { alert('è«‹è¼¸å…¥è‡ªæª¢å…§å®¹ï¼'); return; }
            
            const task = {
                id: Date.now(),
                person: currentPerson,
                building: currentBuilding,
                priority: document.getElementById('selfcheck-priority').value,
                content: content,
                date1: document.getElementById('selfcheck-date1').value,
                date2: document.getElementById('selfcheck-date2').value,
                result: '',
                completed: false,
                time: new Date().toLocaleTimeString('zh-HK', {hour:'2-digit',minute:'2-digit'})
            };
            
            selfcheckTasks.unshift(task);
            saveSelfcheckTasks();
            clearSelfcheckForm();
        }
        
        function saveSelfcheckTasks() {
            localStorage.setItem('selfcheckTasks', JSON.stringify(selfcheckTasks));
            renderSelfcheckTasks();
        }
        
        function clearSelfcheckForm() {
            document.getElementById('selfcheck-content').value = '';
            document.getElementById('selfcheck-date1').value = '';
            document.getElementById('selfcheck-date2').value = '';
            document.getElementById('selfcheck-priority').value = 'medium';
        }
        
        function renderSelfcheckTasks() {
            const container = document.getElementById('selfcheck-list');
            
            // éæ¿¾å‡ºç¬¦åˆé¸æ“‡çš„ä»»å‹™
            let filtered = selfcheckTasks;
            if (currentPerson && currentBuilding) {
                filtered = selfcheckTasks.filter(t => t.person === currentPerson && t.building === currentBuilding);
            }
            
            if (filtered.length === 0) {
                container.innerHTML = '<div class="empty-state">æš«æ™‚å†‡ä»»å‹™ (è«‹é¸æ“‡äººå“¡å’Œåº§æ•¸)</div>';
                return;
            }
            
            container.innerHTML = filtered.map(task => `
                <div class="task-card priority-${task.priority} ${task.completed ? 'å®Œæˆ' : ''}">
                    <div class="task-header">
                        <span class="äººå“¡å">ğŸ‘¤ ${task.person} - ${task.building}</span>
                        <span class="å„ªå…ˆåº¦ ${task.priority}">${task.priority==='high'?'ğŸ”´é«˜':task.priority==='medium'?'ğŸŸ¡ä¸­':'ğŸŸ¢ä½'}</span>
                    </div>
                    <div class="task-content">${task.content}</div>
                    <div class="task-dates">ğŸ“… ${task.date1||'æœªå¡«'} | â° ${task.date2||'æœªå¡«'} | ${task.time}</div>
                    ${task.result ? `<div style="margin-top:8px;padding:8px;background:rgba(0,0,0,0.2);border-radius:5px;">âœ… ${task.result}</div>`:''}
                    <div class="task-actions">
                        <button class="btn btn-primary" style="padding:8px 15px;font-size:0.9em;" onclick="toggleSelfcheckComplete(${task.id})">${task.completed?'â†©ï¸':'âœ…'}</button>
                        <button class="btn" style="padding:8px 15px;font-size:0.9em;" onclick="updateSelfcheckResult(${task.id})">ğŸ“</button>
                        <button class="btn btn-danger" style="padding:8px 15px;font-size:0.9em;" onclick="deleteSelfcheckTask(${task.id})">ğŸ—‘ï¸</button>
                    </div>
                </div>
            `).join('');
        }
        
        function toggleSelfcheckComplete(id) {
            const task = selfcheckTasks.find(t => t.id === id);
            if (task) { task.completed = !task.completed; saveSelfcheckTasks(); }
        }
        
        function updateSelfcheckResult(id) {
            const task = selfcheckTasks.find(t => t.id === id);
            if (task) { task.result = prompt('è¼¸å…¥è™•ç†çµæœï¼š', task.result) || ''; saveSelfcheckTasks(); }
        }
        
        function deleteSelfcheckTask(id) {
            if (confirm('ç¢ºå®šåˆªé™¤ï¼Ÿ')) {
                selfcheckTasks = selfcheckTasks.filter(t => t.id !== id);
                saveSelfcheckTasks();
            }
        }
        
        // å•Ÿå‹•
        init();
    </script>
</body>
</html>
